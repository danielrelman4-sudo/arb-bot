# v9 full-universe stream profile.
# Goal: full universe coverage with stream-safe bootstrap/priority ordering.

# Rules / mapping
ARB_STRUCTURAL_RULES_PATH=arb_bot/config/structural_rules.generated.v3_merged.json
ARB_CROSS_VENUE_MAPPING_PATH=arb_bot/config/cross_venue_map.strict.csv
ARB_CROSS_VENUE_MAPPING_REQUIRED=true
ARB_STRICT_MAPPING_TEMPORAL_JOIN_SECONDS=600
ARB_CROSS_LANE_MIN_COVERED_PAIRS=1
ARB_PARITY_LANE_MIN_COVERED_RULES=1
ARB_ASSUME_STRUCTURAL_BUCKETS_EXHAUSTIVE=false

# Stream-first behavior
ARB_STREAM_RECOMPUTE_COOLDOWN_MS=2000
ARB_POLL_INTERVAL_SECONDS=20
ARB_STREAM_POLL_DECISION_CLOCK=true
ARB_STREAM_FULL_DISCOVERY_INTERVAL_SECONDS=600
ARB_STREAM_LOW_COVERAGE_TRIGGER_CYCLES=3
ARB_STREAM_LOW_COVERAGE_MIN_CROSS_PAIRS=1
ARB_STREAM_LOW_COVERAGE_ENABLE_FULL_SCAN_FALLBACK=true
ARB_UNIVERSE_HOTSET_SIZE=0
ARB_FILL_STALE_HALF_LIFE_SECONDS=300

# Ensure streaming adapters are enabled
KALSHI_ENABLE_STREAM=true
POLYMARKET_ENABLE_STREAM=true

# Full-universe limits
KALSHI_MARKET_LIMIT=1200
KALSHI_MARKET_SCAN_PAGES=30
KALSHI_MARKET_PAGE_SIZE=200
KALSHI_USE_ORDERBOOK_QUOTES=false
KALSHI_MAX_ORDERBOOK_CONCURRENCY=1
KALSHI_REQUEST_PAUSE_SECONDS=0.35
KALSHI_MIN_LIQUIDITY=0.0
KALSHI_STREAM_SUBSCRIPTION_BATCH_SIZE=120
KALSHI_STREAM_SUBSCRIPTION_RETRY_ATTEMPTS=4
KALSHI_STREAM_SUBSCRIPTION_ACK_TIMEOUT_SECONDS=3
KALSHI_STREAM_MAX_TICKERS_PER_SOCKET=220
KALSHI_STREAM_PRIORITY_TICKERS_HARD_CAP=1200
KALSHI_STREAM_PRIORITY_CROSS_QUOTA=500
KALSHI_STREAM_PRIORITY_BUCKET_QUOTA=500
KALSHI_STREAM_PRIORITY_REFRESH_LIMIT=40
KALSHI_STREAM_ALLOW_REST_TOPUP=false
KALSHI_STREAM_BOOTSTRAP_SCAN_PAGES=10
KALSHI_STREAM_BOOTSTRAP_ENRICH_LIMIT=0
KALSHI_EVENTS_429_CIRCUIT_THRESHOLD=4
KALSHI_EVENTS_429_CIRCUIT_COOLDOWN_SECONDS=180

POLYMARKET_MARKET_LIMIT=5000
POLYMARKET_MARKET_SCAN_PAGES=80
POLYMARKET_MARKET_PAGE_SIZE=200
POLYMARKET_PRIORITY_BACKFILL_SCAN_PAGES=300
POLYMARKET_MIN_LIQUIDITY=0.0
POLYMARKET_MAX_ORDERBOOK_CONCURRENCY=4
POLYMARKET_BOOK_RETRY_ATTEMPTS=4
POLYMARKET_BOOK_RETRY_BASE_DELAY_SECONDS=0.25
POLYMARKET_BOOK_RETRY_MAX_DELAY_SECONDS=2.5
POLYMARKET_PRIORITY_MARKET_IDS_HARD_CAP=5000
POLYMARKET_PRIORITY_CROSS_QUOTA=2000
POLYMARKET_PRIORITY_BUCKET_QUOTA=2000

# Keep all lanes active
ARB_LANE_INTRA_ENABLED=true
ARB_LANE_CROSS_ENABLED=true
ARB_LANE_STRUCTURAL_BUCKET_ENABLED=true
ARB_LANE_STRUCTURAL_EVENT_TREE_ENABLED=true
ARB_LANE_STRUCTURAL_PARITY_ENABLED=true

# Lane thresholds (close to v9 baseline)
ARB_LANE_INTRA_MIN_NET_EDGE_PER_CONTRACT=0.0002
ARB_LANE_INTRA_MIN_EXPECTED_PROFIT_USD=0.0040
ARB_LANE_INTRA_MIN_FILL_PROBABILITY=0.90
ARB_LANE_INTRA_MIN_REALIZED_PROFIT_USD=0.0020

ARB_LANE_CROSS_MIN_NET_EDGE_PER_CONTRACT=0.0002
ARB_LANE_CROSS_MIN_EXPECTED_PROFIT_USD=0.0015
ARB_LANE_CROSS_MIN_FILL_PROBABILITY=0.72
ARB_LANE_CROSS_MIN_REALIZED_PROFIT_USD=0.0008

ARB_LANE_STRUCTURAL_BUCKET_MIN_NET_EDGE_PER_CONTRACT=0.0005
ARB_LANE_STRUCTURAL_BUCKET_MIN_EXPECTED_PROFIT_USD=0.0020
ARB_LANE_STRUCTURAL_BUCKET_MIN_FILL_PROBABILITY=0.70
ARB_LANE_STRUCTURAL_BUCKET_MIN_REALIZED_PROFIT_USD=0.0010

ARB_LANE_STRUCTURAL_PARITY_MIN_NET_EDGE_PER_CONTRACT=0.0002
ARB_LANE_STRUCTURAL_PARITY_MIN_EXPECTED_PROFIT_USD=0.0015
ARB_LANE_STRUCTURAL_PARITY_MIN_FILL_PROBABILITY=0.72
ARB_LANE_STRUCTURAL_PARITY_MIN_REALIZED_PROFIT_USD=0.0008

# Cooldown is side-aware so cross/parity can use the opposite side of the
# same market in a single cycle when both are valid.
ARB_MARKET_COOLDOWN_SCOPE=market_side
ARB_OPPORTUNITY_COOLDOWN_SECONDS=900

# Signal-maximizing structural bucket quality model
ARB_BUCKET_QUALITY_ENABLED=true
ARB_BUCKET_QUALITY_HISTORY_GLOB=arb_bot/output/paper_*.csv
ARB_BUCKET_QUALITY_HISTORY_MAX_FILES=50
ARB_BUCKET_QUALITY_MIN_OBSERVATIONS=6
ARB_BUCKET_QUALITY_MAX_ACTIVE_BUCKETS=0
ARB_BUCKET_QUALITY_EXPLORE_FRACTION=0.20
ARB_BUCKET_QUALITY_PRIOR_MEAN_REALIZED_PROFIT=0.002
ARB_BUCKET_QUALITY_PRIOR_STRENGTH=12
ARB_BUCKET_QUALITY_MIN_SCORE=-0.01
ARB_BUCKET_QUALITY_LEG_COUNT_PENALTY=0.00030
ARB_BUCKET_QUALITY_LIVE_UPDATE_INTERVAL=20

# Capacity limits
ARB_MAX_OPEN_MARKETS_PER_VENUE=120
ARB_MAX_OPEN_POSITIONS_PER_CLUSTER=16
